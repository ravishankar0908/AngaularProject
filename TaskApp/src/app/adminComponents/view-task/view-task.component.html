<app-admin-header />

<div class="table">
  <div class="table-content">
    <h1>Tasks Details</h1>
    <div *ngIf="taskDetails.length === 0">
      <hr />
      <p
        style="
          text-align: center;
          color: red;
          font-size: 20px;
          margin-top: 10px;
        "
      >
        No Task is Available!
      </p>
    </div>
    <section class="table-example">
      <table
        *ngIf="taskDetails.length > 0"
        mat-table
        [dataSource]="taskDetails"
        class="mat-elevation-z8"
      >
        <ng-container matColumnDef="position">
          <th mat-header-cell *matHeaderCellDef>No.</th>
          <td mat-cell *matCellDef="let element; let i = index">
            {{ i + 1 }}
          </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Task Name</th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Task Description</th>
          <td
            mat-cell
            *matCellDef="let element"
            [ngStyle]="{ 'white-space': 'pre-wrap' }"
          >
            {{ element.description }}
          </td>
        </ng-container>

        <ng-container matColumnDef="created">
          <th mat-header-cell *matHeaderCellDef>Task Created Date</th>
          <td mat-cell *matCellDef="let element">
            {{ element.createdAt | date : "dd MMMM YYYY" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="duedate">
          <th mat-header-cell *matHeaderCellDef>Task Due Date</th>
          <td mat-cell *matCellDef="let element">
            {{ element.dueDate | date : "dd MMMM YYYY" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="employee">
          <th mat-header-cell *matHeaderCellDef>Employee Name</th>
          <td mat-cell *matCellDef="let element">
            {{
              element.employeeDetails.firstName +
                " " +
                element.employeeDetails.lastName
            }}
          </td>
        </ng-container>

        <ng-container matColumnDef="manager">
          <th mat-header-cell *matHeaderCellDef>Manager Name</th>
          <td mat-cell *matCellDef="let element">
            {{
              element.managerDetails.firstName +
                " " +
                element.managerDetails.lastName
            }}
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Task Status</th>
          <td
            mat-cell
            *matCellDef="let element"
            [ngClass]="getStatusClass(element.status)"
          >
            {{ element.status }}
          </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef>Action</th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-icon-button
              matTooltip="restore the task"
              *ngIf="element.isDelete"
              (click)="restoreTask(element._id)"
            >
              <mat-icon>restore</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns; sticky: true"
          [ngClass]="{ header: true }"
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          [ngClass]="{
            'highlight-row': isPastDue(row.dueDate),
            'delete-row': isDelete(row.isDelete)
          }"
        ></tr>
      </table>
    </section>
  </div>
</div>
