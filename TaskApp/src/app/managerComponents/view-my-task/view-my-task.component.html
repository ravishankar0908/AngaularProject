<app-manager-header />

<div class="table">
  <div class="table-content">
    <h1>My Task Details</h1>
    <div *ngIf="myTask.length === 0">
      <hr />
      <p
        style="
          text-align: center;
          font-size: 25px;
          color: red;
          margin-top: 20px;
        "
      >
        You have not posted any task yet.
      </p>
    </div>

    <section class="table-example">
      <table
        mat-table
        [dataSource]="myTask"
        class="mat-elevation-z8"
        *ngIf="myTask.length > 0"
      >
        <ng-container matColumnDef="position">
          <th mat-header-cell *matHeaderCellDef>No.</th>
          <td mat-cell *matCellDef="let element; let i = index">
            {{ i + 1 }}
          </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Task Name</th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <ng-container matColumnDef="created">
          <th mat-header-cell *matHeaderCellDef>Task Created Date</th>
          <td mat-cell *matCellDef="let element">
            {{ element.createdAt | date : "dd MMMM YYYY" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="duedate">
          <th mat-header-cell *matHeaderCellDef>Task Due Date</th>
          <td mat-cell *matCellDef="let element">
            {{ element.dueDate | date : "dd MMMM YYYY" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Task Description</th>
          <td
            mat-cell
            *matCellDef="let element"
            [ngStyle]="{ 'white-space': 'pre-wrap' }"
          >
            {{ element.description }}
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Task Status</th>
          <td
            mat-cell
            *matCellDef="let element"
            [ngClass]="getStatusClass(element.status)"
          >
            {{ element.status }}
          </td>
        </ng-container>

        <ng-container matColumnDef="employeeName">
          <th mat-header-cell *matHeaderCellDef>Assigned Employee Name</th>
          <td mat-cell *matCellDef="let element">
            {{
              element.employeeId.firstName + " " + element.employeeId.lastName
            }}
          </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef style="text-align: center">
            Action
          </th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-icon-button
              matTooltip="edit task"
              (click)="updateTask(element._id)"
            >
              <mat-icon style="color: rgb(1, 119, 3)" matSuffix>edit</mat-icon>
            </button>
            <button
              mat-icon-button
              matTooltip="delete task"
              (click)="deleteMyTask(element._id)"
            >
              <mat-icon style="color: rgb(202, 48, 5)" matSuffix
                >delete</mat-icon
              >
            </button>
          </td>
        </ng-container>

        <ng-container matColumnDef="submit">
          <th mat-header-cell *matHeaderCellDef>Task Submitted Date</th>
          <td mat-cell *matCellDef="let element">
            <ng-container *ngIf="element.status === 'completed'">{{
              element.updatedAt | date : "dd MMMM YYYY"
            }}</ng-container>
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns; sticky: true"
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          [ngClass]="{ 'highlight-row': isPastDue(row.dueDate) }"
        ></tr>
      </table>
    </section>
  </div>
</div>
